

random.seed(42)
np.random.seed(42)

# Dataset name
dataset_name = 'ml-100k'

isHint = True
sample_method = 'uniform'  # importance

# Load data for ml-100k
df_like = pd.read_csv('/nfs/RecRanker/llm_recommender/Datasets/train_set.txt', names=['u', 'i', 'r', 't'], sep=' ')
df_dislike = pd.read_csv('/nfs/RecRanker/llm_recommender/Datasets/dislike.txt', header=None, names=['u', 'i', 'r', 't'])
movie_info = pd.read_csv('/nfs/RecRanker/llm_recommender/Datasets/movie_info.csv', header=None,
                         names=['movie_id', 'movie_name', 'url', 'genre', 'genr0', 'genre1', 'genre2', 'genre3',
                                'genre4', 'genre5', 'genre6', 'genre7', 'genre8', 'genre9', 'genre10',
                                'genre11', 'genre12', 'genre13', 'genre14', 'genre15', 'genre16', 'genre17',
                                'genre18', 'genre19'], sep='|', engine='python', encoding='latin-1')


movie_id_list = movie_info['movie_id'].tolist()
movie_name_list = movie_info['movie_name'].tolist()
movie_name_dict = {movie_id_list[i]: movie_name_list[i] for i in range(len(movie_name_list))}

kws = 'movie'

def sort_list_reverse_with_indices(lst):
    sorted_indices = sorted(enumerate(lst), key=lambda x: x[1], reverse=True)
    sorted_indices = [index for index, _ in sorted_indices]
    return sorted_indices

with open('/nfs/RecRanker/llm_recommender/Datasets/ml-100k_item.pkl', "rb") as file:
    cm_item = pickle.load(file)
with open('/nfs/RecRanker/llm_recommender/Datasets/ml-100k_user.pkl', "rb") as file:
    cm_user = pickle.load(file)
with open('/nfs/RecRanker/llm_recommender/Datasets/ml-100k_pred.pkl', "rb") as file:
    cm_pred = pickle.load(file)

with open('/nfs/RecRanker/llm_recommender/Datasets/ml-100k_user_emb.pkl', "rb") as file:
    cm_user_emb = pickle.load(file)

with open('/nfs/RecRanker/llm_recommender/Datasets/item_id_mapping.pkl', "rb") as file:
    mf_item = pickle.load(file)
with open('/nfs/RecRanker/llm_recommender/Datasets/user_id_mapping.pkl', "rb") as file:
    mf_user = pickle.load(file)
with open('/nfs/RecRanker/llm_recommender/Datasets/rating_matrix.pkl', "rb") as file:
    mf_pred = pickle.load(file)

